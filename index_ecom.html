<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>A7T | Nutrition & Energy Router</title><link href="/index_ecom.8c195a16.css" rel="stylesheet"><style>body{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);justify-content:center;align-items:center;min-height:100vh;display:flex}.login-container{background:#fff;border-radius:15px;width:100%;max-width:400px;overflow:hidden;box-shadow:0 15px 35px #0000001a}.login-header{color:#fff;text-align:center;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:2rem}.login-body{padding:2rem}.form-floating{margin-bottom:1rem}.btn-login{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border:none;border-radius:25px;width:100%;margin-top:1rem;padding:12px;font-weight:600}.btn-login:hover{transform:translateY(-2px);box-shadow:0 5px 15px #0003}.alert{border-radius:10px;margin-top:1rem}.register-link{text-align:center;margin-top:1rem}.register-link a{color:#667eea;text-decoration:none}.register-link a:hover{text-decoration:underline}.loading{display:none}.spinner-border-sm{width:1rem;height:1rem}</style></head><body> <div class="container"> <div class="justify-content-center row"> <div class="col-lg-4 col-md-6"> <div class="login-container"> <div class="login-header" style="background-color:0x00000000"> <span style="font-size:3.5rem;line-height:1" title="Air">&#x1F701;</span> <h3><b>A7T</b></h3> <p class="mb-0">08.08.2025</p> </div> <div class="login-body" style="box-shadow:none!important;background:0 0!important"> <form id="loginForm"> <div class="form-floating"> <input type="email" class="form-control" id="email" placeholder="name@example.com" required> <label for="email">Email address</label> </div> <div class="form-floating"> <input type="password" class="form-control" id="password" placeholder="Password" required> <label for="password">Password</label> </div> <button type="submit" class="btn btn-login btn-primary" id="loginBtn"> <span class="btn-text">Sign In</span> <span class="loading"> <span class="me-2 spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Signing in... </span> </button> </form> <div id="alertContainer"></div> <div class="register-link"> <p>Don't have an account? <a href="#" onclick="showRegisterForm()">Register here</a></p> </div> </div> </div> </div> </div> </div>  <div class="fade modal" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <h5 class="modal-title" id="registerModalLabel">Create Account</h5> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> </div> <div class="modal-body"> <form id="registerForm"> <div class="mb-3"> <label for="regUsername" class="form-label">Username</label> <input type="text" class="form-control" id="regUsername" required> </div> <div class="mb-3"> <label for="regEmail" class="form-label">Email address</label> <input type="email" class="form-control" id="regEmail" required> </div> <div class="mb-3"> <label for="regPassword" class="form-label">Password</label> <input type="password" class="form-control" id="regPassword" required> </div> <button type="submit" class="btn btn-primary w-100">Create Account</button> </form> <div id="registerAlertContainer"></div> </div> </div> </div> </div>  <script src="/index_ecom.253cc152.js"></script> <script>let e="/api";function t(e,t){document.getElementById("alertContainer").innerHTML=`
                <div class="alert alert-${e} alert-dismissible fade show" role="alert">
                    ${t}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            `}function n(e,t){document.getElementById("registerAlertContainer").innerHTML=`
                <div class="alert alert-${e} alert-dismissible fade show" role="alert">
                    ${t}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            `}function o(){let n=localStorage.getItem("access_token");if(!n){t("danger","No token found");return}console.log("Using token:",n),fetch(`${e}/debug-token?token=${encodeURIComponent(n)}`).then(e=>e.json()).then(o=>{if(console.log("Token debug:",o),!o.valid){t("danger","Invalid token: "+o.error);return}return fetch(`${e}/getusers`,{headers:{Authorization:`Bearer ${n}`}})}).then(e=>{if(e&&e.ok)return e.json();if(e)throw Error(`HTTP ${e.status}: ${e.statusText}`)}).then(e=>{e&&(document.querySelector(".login-container").innerHTML=`
                            <div class="login-header">
                                <i class="fas fa-user-check fa-3x mb-3"></i>
                                <h3>Welcome!</h3>
                                <p class="mb-0">You are successfully logged in</p>
                            </div>
                            <div class="login-body">
                                <div class="text-center mb-4">
                                    <h5>User Information</h5>
                                    <p class="text-muted">Total users in system: ${e.length}</p>
                                </div>
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary" onclick="window.location.href='/api/catalog'">
                                        <i class="fas fa-shopping-bag me-2"></i>View Products
                                    </button>
                                    <button class="btn btn-outline-primary" onclick="changePassword()">
                                        <i class="fas fa-key me-2"></i>Change Password
                                    </button>
                                    <button class="btn btn-outline-danger" onclick="logout()">
                                        <i class="fas fa-sign-out-alt me-2"></i>Logout
                                    </button>
                                </div>
                            </div>
                        `)}).catch(e=>{console.error("Error fetching user data:",e),t("danger","Error loading user data: "+e.message)})}("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)&&(e="http://localhost:8000"),document.getElementById("loginForm").addEventListener("submit",async function(n){n.preventDefault();let a=document.getElementById("email").value,s=document.getElementById("password").value,r=document.getElementById("loginBtn"),l=r.querySelector(".btn-text"),i=r.querySelector(".loading");l.style.display="none",i.style.display="inline-block",r.disabled=!0;try{let n=await fetch(`${e}/login`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`email=${encodeURIComponent(a)}&password=${encodeURIComponent(s)}`}),r=await n.json();n.ok?(localStorage.setItem("access_token",r.access_token),localStorage.setItem("refresh_token",r.refresh_token),t("success","Login successful! Redirecting..."),console.log("Token received:",r.access_token),setTimeout(()=>{o()},1500)):t("danger",r.detail||"Login failed")}catch(e){t("danger","Network error. Please try again."),console.error("Login error:",e)}finally{l.style.display="inline-block",i.style.display="none",r.disabled=!1}}),document.getElementById("registerForm").addEventListener("submit",async function(t){t.preventDefault();let o=document.getElementById("regUsername").value,a=document.getElementById("regEmail").value,s=document.getElementById("regPassword").value;try{let t=await fetch(`${e}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:o,email:a,password:s})}),r=await t.json();t.ok?(n("success","Account created successfully! You can now login."),document.getElementById("registerForm").reset()):n("danger",r.detail||"Registration failed")}catch(e){n("danger","Network error. Please try again."),console.error("Registration error:",e)}}),window.addEventListener("load",function(){localStorage.getItem("access_token")&&o()});</script> </body></html>